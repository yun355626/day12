<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>å¦™éº—æ­²æ•¸è¨ˆç®—æ©Ÿ</title>

  <style>
    * {
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    /* èƒŒæ™¯ï¼šæŸ”å’Œæ¼¸å±¤ï¼Œæ‰‹æ©Ÿå„ªå…ˆ */
    body {
      margin: 0;
      padding: 16px 12px 24px;
      min-height: 100vh;
      background: radial-gradient(circle at top, #ffe9f5 0, #fef5ff 40%, #f6f7ff 100%);
    }

    /* ä¸»å¡ç‰‡ï¼šåƒä¸€å€‹ App ç•«é¢ï¼Œå·¦å³ç•™ç™½ */
    .app-container {
      max-width: 420px;
      margin: 0 auto;
      background: #ffffff;
      border-radius: 20px;
      padding: 18px 18px 20px;
      box-shadow: 0 10px 26px rgba(0, 0, 0, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.9);
    }

    /* é ‚éƒ¨ï¼šç‹—ç‹—ç…§ç‰‡ + æ¨™é¡Œ + èªªæ˜ï¼ˆå…¨éƒ¨ç½®ä¸­ï¼‰ */
    .dog-photo {
      width: 110px;
      height: 110px;
      border-radius: 50%;
      overflow: hidden;
      margin: 4px auto 10px;
      border: 4px solid #fff;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.12);
    }

    .dog-photo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .app-title {
      font-size: 20px;
      font-weight: 700;
      text-align: center;
      color: #333;
      margin-bottom: 4px;
    }

    .subtitle {
      font-size: 12px;
      text-align: center;
      color: #777;
      margin-bottom: 16px;
    }

    /* è¼¸å…¥å€ */
    .input-group {
      margin-bottom: 8px;
    }

    label {
      display: block;
      font-size: 13px;
      color: #444;
      margin-bottom: 4px;
    }

    input[type="date"] {
      width: 100%;
      padding: 9px 10px;
      border-radius: 10px;
      border: 1px solid #ddd;
      font-size: 14px;
      background: #fafafa;
      outline: none;
      transition: border-color 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    }

    input[type="date"]:focus {
      border-color: #a96dff;
      box-shadow: 0 0 0 2px rgba(169, 109, 255, 0.25);
      background: #ffffff;
    }

    .hint-text {
      margin-top: 4px;
      font-size: 11px;
      color: #999;
    }

    /* æŒ‰éˆ• */
    .btn {
      width: 100%;
      margin-top: 12px;
      padding: 11px 16px;
      border-radius: 999px;
      border: none;
      font-size: 15px;
      font-weight: 700;
      cursor: pointer;
      color: #fff;
      background: linear-gradient(135deg, #7f6dff, #c46dff);
      box-shadow: 0 4px 12px rgba(120, 88, 255, 0.35);
      transition: transform 0.08s ease, box-shadow 0.08s ease;
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 14px rgba(120, 88, 255, 0.4);
    }

    .btn:active {
      transform: translateY(0);
      box-shadow: 0 3px 8px rgba(120, 88, 255, 0.25);
    }

    /* çµæœå¤–æ¡† */
    .result-wrapper {
      margin-top: 16px;
      padding: 10px 10px 8px;
      border-radius: 14px;
      background: #fff7f3;
      border: 1px solid #ffe0d1;
    }

    .result-title-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
      font-size: 12px;
      color: #555;
    }

    .last-time {
      font-size: 11px;
      color: #999;
    }

    /* å…©å€‹çµæœå¡ç‰‡ï¼ˆç‹—ç‹—å¹´é½¡ / äººé¡å¹´é½¡ï¼‰ */
    .result-cards {
      display: flex;
      gap: 8px;
      margin-bottom: 6px;
    }

    .result-card {
      flex: 1;
      padding: 8px 8px 6px;
      border-radius: 10px;
      background: #ffe4da;
      text-align: center;
    }

    .result-card.secondary {
      background: #ffd9e7;
    }

    .result-label {
      font-size: 11px;
      color: #555;
      margin-bottom: 2px;
    }

    .result-value {
      font-size: 18px;
      font-weight: 700;
      color: #c64646;
    }

    .result-unit {
      font-size: 11px;
      color: #555;
      margin-left: 2px;
    }

    .result-text {
      font-size: 12px;
      color: #503434;
      line-height: 1.5;
    }

    .result-placeholder {
      font-size: 12px;
      color: #777;
      line-height: 1.5;
    }

    .error {
      color: #d64545;
      font-weight: 700;
    }

    .formula {
      margin-top: 8px;
      font-size: 11px;
      color: #999;
      text-align: center;
    }

    @media (max-width: 360px) {
      body {
        padding: 10px 8px 18px;
      }
      .app-container {
        padding: 16px 14px 18px;
        border-radius: 16px;
      }
      .result-cards {
        flex-direction: column;
      }
    }
  </style>
</head>

<body>
  <div class="app-container">
    <!-- é ‚éƒ¨ï¼šç‹—ç‹—ç…§ç‰‡ + æ¨™é¡Œ + èªªæ˜ -->
    <div class="dog-photo">
      <!-- é€™è£¡å¯ä»¥æ›æˆä½ è‡ªå·±çš„å¦™éº—ç…§ç‰‡æˆ– Unsplash åœ–ç‰‡ -->
      <img
        src="https://images.unsplash.com/photo-1548199973-03cce0bbc87b?auto=format&fit=crop&w=500&q=60"
        alt="å¦™éº—çš„ç…§ç‰‡">
    </div>

    <div class="app-title">ğŸ¶ å¦™éº—æ­²æ•¸è¨ˆç®—æ©Ÿ</div>
    <div class="subtitle">è¼¸å…¥å¦™éº—çš„å‡ºç”Ÿæ—¥æœŸï¼Œå¹«ä½ æ›ç®—æˆã€Œäººé¡å¹´é½¡ã€ï¼</div>

    <!-- æ—¥æœŸè¼¸å…¥ -->
    <div class="input-group">
      <label for="birthDate">å¦™éº—çš„å‡ºç”Ÿæ—¥æœŸï¼š</label>
      <input type="date" id="birthDate" value="2023-02-28">
      <div class="hint-text">
        é¸å¥½æ—¥æœŸå¾ŒæŒ‰ä¸‹ã€Œé–‹å§‹è¨ˆç®—ã€ã€‚ä¸‹æ¬¡æ‰“é–‹æœƒè‡ªå‹•è¨˜ä½ä¸Šæ¬¡çš„æ—¥æœŸå’Œçµæœã€‚
      </div>
    </div>

    <!-- æŒ‰éˆ• -->
    <button id="calculateBtn" class="btn">é–‹å§‹è¨ˆç®—</button>

    <!-- çµæœå€ -->
    <div id="result" class="result-wrapper">
      <div class="result-title-row">
        <span>ç›®å‰çµæœ</span>
        <span id="lastTime" class="last-time"></span>
      </div>

      <div id="resultContent">
        <div class="result-placeholder">
          é‚„æ²’æœ‰è¨ˆç®—ç´€éŒ„ã€‚<br>
          è«‹å…ˆé¸æ“‡å¦™éº—çš„å‡ºç”Ÿæ—¥æœŸï¼Œå†æŒ‰ã€Œé–‹å§‹è¨ˆç®—ã€ã€‚
        </div>
      </div>
    </div>

    <div class="formula">
      å…¬å¼ï¼šäººé¡å¹´é½¡ = 16 Ã— ln(ç‹—ç‹—å¯¦éš›å¹´æ•¸) + 31ï¼ˆln ç‚ºè‡ªç„¶å°æ•¸ï¼‰
    </div>
  </div>

<script>
  const dogName = "å¦™éº—";
  const STORAGE_KEY = "miaoLiDogAgeResult";

  const birthInput = document.getElementById("birthDate");
  const resultContainer = document.getElementById("resultContent");
  const lastTimeSpan = document.getElementById("lastTime");
  const calculateBtn = document.getElementById("calculateBtn");

  function renderResult(dogAgeDisplay, humanAgeDisplay, savedAtText) {
    resultContainer.innerHTML = `
      <div class="result-cards">
        <div class="result-card">
          <div class="result-label">ç‹—ç‹—å¹´é½¡</div>
          <div>
            <span class="result-value">${dogAgeDisplay}</span>
            <span class="result-unit">æ­²</span>
          </div>
        </div>
        <div class="result-card secondary">
          <div class="result-label">æ›ç®—æˆäººé¡å¹´é½¡</div>
          <div>
            <span class="result-value">${humanAgeDisplay}</span>
            <span class="result-unit">æ­²</span>
          </div>
        </div>
      </div>
      <div class="result-text">
        ${dogName}ç¾åœ¨å¤§ç´„æ˜¯ <b>${dogAgeDisplay}</b> æ­²çš„ç‹—ç‹—å¹´é½¡ï¼Œ<br>
        å¦‚æœæ›æˆäººé¡ï¼Œå°±æ˜¯å·®ä¸å¤š <b>${humanAgeDisplay}</b> æ­²çš„äººã€‚
      </div>
    `;
    lastTimeSpan.textContent = savedAtText ? `ä¸Šæ¬¡è¨ˆç®—ï¼š${savedAtText}` : "";
  }

  function renderError(message) {
    resultContainer.innerHTML = `<div class="result-placeholder error">${message}</div>`;
    lastTimeSpan.textContent = "";
  }

  // âœ… å¹«æ™‚é–“åšä¸€å€‹çµ±ä¸€çš„ã€Œæ¼‚äº®æ ¼å¼ã€
  function formatDateTime(raw) {
    const d = new Date(raw);
    if (isNaN(d.getTime())) return raw; // å¦‚æœè§£æå¤±æ•—å°±åŸæ¨£é¡¯ç¤ºï¼ˆé˜²å‘†ï¼‰

    return d.toLocaleString("zh-TW", {
      year: "numeric",
      month: "2-digit",
      day: "2-digit",
      hour: "2-digit",
      minute: "2-digit"
    });
  }

  // âœ… å­˜çš„æ™‚å€™å°±å­˜ã€Œå·²æ’ç‰ˆå¥½çš„åœ¨åœ°æ™‚é–“ã€
  function saveToStorage(birthDateStr, dogAgeDisplay, humanAgeDisplay) {
    const now = new Date();
    const savedAt = formatDateTime(now); // é€™è£¡æœƒå¾—åˆ°é¡ä¼¼ã€Œ2025/11/18 14:32ã€

    const payload = {
      birthDate: birthDateStr,
      dogAge: dogAgeDisplay,
      humanAge: humanAgeDisplay,
      savedAt
    };
    localStorage.setItem(STORAGE_KEY, JSON.stringify(payload));
    return savedAt;
  }

  // âœ… è¼‰å…¥èˆŠè³‡æ–™æ™‚ï¼Œå¦‚æœ savedAt æ˜¯èˆŠç‰ˆ ISO ä¹Ÿæœƒè¢« formatDateTime ç¾åŒ–
  function loadFromStorage() {
    const raw = localStorage.getItem(STORAGE_KEY);
    if (!raw) return;

    try {
      const data = JSON.parse(raw);
      if (data.birthDate) {
        birthInput.value = data.birthDate;
      }
      if (data.dogAge && data.humanAge) {
        const niceTime = data.savedAt ? formatDateTime(data.savedAt) : "";
        renderResult(data.dogAge, data.humanAge, niceTime);
      }
    } catch (e) {
      console.warn("è§£æ localStorage å¤±æ•—ï¼š", e);
    }
  }

  calculateBtn.addEventListener("click", () => {
    const birthValue = birthInput.value;

    if (!birthValue) {
      renderError("è«‹å…ˆé¸æ“‡å¦™éº—çš„å‡ºç”Ÿæ—¥æœŸå–”ï¼");
      return;
    }

    const birthDate = new Date(birthValue);
    const today = new Date();

    if (birthDate > today) {
      renderError("å‡ºç”Ÿæ—¥æœŸä¸èƒ½æ˜¯æœªä¾†çš„æ—¥æœŸï½");
      return;
    }

    const diffMs = today - birthDate;
    const years = diffMs / (1000 * 60 * 60 * 24 * 365.25);

    if (years <= 0) {
      renderError(`${dogName}ç¾åœ¨é‚„æ˜¯å‰›å‡ºç”Ÿçš„å°å¯¶å¯¶ï¼Œå¹´é½¡å¤ªå°æš«æ™‚ç„¡æ³•æ›ç®—æˆäººé¡å¹´é½¡å–”ï¼`);
      return;
    }

    const dogAgeYears = years;
    const humanAgeYears = 16 * Math.log(dogAgeYears) + 31;

    const dogAgeDisplay = dogAgeYears.toFixed(1);
    const humanAgeDisplay = humanAgeYears.toFixed(1);

    const savedAt = saveToStorage(birthValue, dogAgeDisplay, humanAgeDisplay);
    renderResult(dogAgeDisplay, humanAgeDisplay, savedAt);
  });

  document.addEventListener("DOMContentLoaded", loadFromStorage);
</script>

</body>
</html>
